{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nvar KEYS = {\n  TICKET: 'hr_ticket',\n  SCAN_QUEUE: 'hr_scan_queue',\n  CONSENT: 'hr_loc_consent'\n};\nexport var saveTicketOffline = function () {\n  var _ref = _asyncToGenerator(function* (ticket) {\n    try {\n      var data = _objectSpread(_objectSpread({}, ticket), {}, {\n        offline_cached: true,\n        cached_at: new Date().toISOString()\n      });\n      yield AsyncStorage.setItem(KEYS.TICKET, JSON.stringify(data));\n    } catch (e) {\n      console.error('Save ticket failed', e);\n    }\n  });\n  return function saveTicketOffline(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getOfflineTicket = function () {\n  var _ref2 = _asyncToGenerator(function* () {\n    try {\n      var json = yield AsyncStorage.getItem(KEYS.TICKET);\n      return json ? JSON.parse(json) : null;\n    } catch (e) {\n      return null;\n    }\n  });\n  return function getOfflineTicket() {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var queueScan = function () {\n  var _ref3 = _asyncToGenerator(function* (ticketData) {\n    try {\n      var existing = yield getScanQueue();\n      var newQueue = [].concat(_toConsumableArray(existing), [{\n        data: ticketData,\n        scanned_at: new Date().toISOString()\n      }]);\n      yield AsyncStorage.setItem(KEYS.SCAN_QUEUE, JSON.stringify(newQueue));\n    } catch (e) {\n      console.error('Queue scan failed', e);\n    }\n  });\n  return function queueScan(_x2) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var getScanQueue = function () {\n  var _ref4 = _asyncToGenerator(function* () {\n    try {\n      var json = yield AsyncStorage.getItem(KEYS.SCAN_QUEUE);\n      return json ? JSON.parse(json) : [];\n    } catch (e) {\n      return [];\n    }\n  });\n  return function getScanQueue() {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var clearScanQueue = function () {\n  var _ref5 = _asyncToGenerator(function* () {\n    yield AsyncStorage.removeItem(KEYS.SCAN_QUEUE);\n  });\n  return function clearScanQueue() {\n    return _ref5.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["AsyncStorage","KEYS","TICKET","SCAN_QUEUE","CONSENT","saveTicketOffline","_ref","_asyncToGenerator","ticket","data","_objectSpread","offline_cached","cached_at","Date","toISOString","setItem","JSON","stringify","e","console","error","_x","apply","arguments","getOfflineTicket","_ref2","json","getItem","parse","queueScan","_ref3","ticketData","existing","getScanQueue","newQueue","concat","_toConsumableArray","scanned_at","_x2","_ref4","clearScanQueue","_ref5","removeItem"],"sources":["C:/Users/avibh/OneDrive/Desktop/HR RoadWays/frontend/utils/storage.js"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst KEYS = {\r\n  TICKET: 'hr_ticket',\r\n  SCAN_QUEUE: 'hr_scan_queue',\r\n  CONSENT: 'hr_loc_consent'\r\n};\r\n\r\n// --- PASSENGER ---\r\n\r\nexport const saveTicketOffline = async (ticket) => {\r\n  try {\r\n    const data = { ...ticket, offline_cached: true, cached_at: new Date().toISOString() };\r\n    await AsyncStorage.setItem(KEYS.TICKET, JSON.stringify(data));\r\n  } catch (e) { console.error('Save ticket failed', e); }\r\n};\r\n\r\nexport const getOfflineTicket = async () => {\r\n  try {\r\n    const json = await AsyncStorage.getItem(KEYS.TICKET);\r\n    return json ? JSON.parse(json) : null;\r\n  } catch (e) { return null; }\r\n};\r\n\r\n// --- DRIVER ---\r\n\r\nexport const queueScan = async (ticketData) => {\r\n  try {\r\n    const existing = await getScanQueue();\r\n    const newQueue = [...existing, { data: ticketData, scanned_at: new Date().toISOString() }];\r\n    await AsyncStorage.setItem(KEYS.SCAN_QUEUE, JSON.stringify(newQueue));\r\n  } catch (e) { console.error('Queue scan failed', e); }\r\n};\r\n\r\nexport const getScanQueue = async () => {\r\n  try {\r\n    const json = await AsyncStorage.getItem(KEYS.SCAN_QUEUE);\r\n    return json ? JSON.parse(json) : [];\r\n  } catch (e) { return []; }\r\n};\r\n\r\nexport const clearScanQueue = async () => {\r\n  await AsyncStorage.removeItem(KEYS.SCAN_QUEUE);\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}